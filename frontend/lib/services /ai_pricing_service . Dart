class AIPricingService {
  // محاسبه قیمت پیشنهادی AI
  double calculateSuggestedPrice({
    required String type,
    required double area,
    required int roomCount,
    required String neighborhood,
  }) {
    // قیمت پایه بر اساس نوع ملک
    double basePrice = _getBasePrice(type);
    
    // محاسبه بر اساس متراژ
    double areaPrice = area * basePrice;
    
    // اضافه کردن بهای اتاق‌ها
    double roomPrice = roomCount * 125000000;
    
    // ضریب منطقه
    double locationFactor = _getLocationFactor(neighborhood);
    
    // قیمت نهایی
    double finalPrice = (areaPrice + roomPrice) * locationFactor;
    
    // اضافه کردن ۵٪ رشد بازار
    return finalPrice * 1.05;
  }
  
  double _getBasePrice(String type) {
    switch (type) {
      case 'apartment': return 50000000;  // 50 میلیون به ازای هر متر
      case 'villa': return 75000000;      // 75 میلیون
      case 'land': return 30000000;       // 30 میلیون
      case 'shop': return 60000000;       // 60 میلیون
      default: return 40000000;           // 40 میلیون
    }
  }
  
  double _getLocationFactor(String neighborhood) {
    // فاکتور منطقه‌ای
    const factors = {
      'نیاوران': 1.8,
      'شهران': 1.6,
      'سعادت‌آباد': 1.5,
      'پونک': 1.2,
      'ستارخان': 1.0,
      'آرارات': 0.9,
    };
    
    return factors[neighborhood] ?? 1.0;
  }
  
  // تولید توضیح برای قیمت پیشنهادی
  String generateExplanation({
    required double price,
    required String type,
    required double area,
    required int roomCount,
  }) {
    return 'قیمت پیشنهادی: ${_formatPrice(price)}\n'
           'بر اساس:\n'
           '• نوع ملک: ${_getTypeName(type)}\n'
           '• متراژ: ${area.toInt()} متر\n'
           '• تعداد اتاق: $roomCount\n'
           '• میانگین قیمت منطقه';
  }
  
  String _getTypeName(String type) {
    switch (type) {
      case 'apartment': return 'آپارتمان';
      case 'villa': return 'ویلا';
      case 'land': return 'زمین';
      case 'shop': return 'مغازه';
      default: return 'ملک';
    }
  }
  
  String _formatPrice(double price) {
    if (price >= 1000000000) {
      return '${(price / 1000000000).toStringAsFixed(1)} میلیارد تومان';
    } else if (price >= 1000000) {
      return '${(price / 1000000).toStringAsFixed(0)} میلیون تومان';
    }
    return price.toStringAsFixed(0);
  }
}
